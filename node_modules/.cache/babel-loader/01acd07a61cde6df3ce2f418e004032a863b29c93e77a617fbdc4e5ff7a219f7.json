{"ast":null,"code":"import { ref, onMounted } from 'vue';\nimport { collection, addDoc, onSnapshot } from 'firebase/firestore';\nimport { db } from '../firebaseConfig';\nimport { auth } from '../firebaseConfig';\nimport MessageList from '../components/MessageList.vue';\nimport MessageInput from '../components/MessageInput.vue';\nimport 'firebase/auth';\nimport 'firebase/firestore';\nexport default {\n  components: {\n    MessageList,\n    MessageInput\n  },\n  setup() {\n    const messages = ref([]);\n    const fetchMessages = () => {\n      const q = collection(db, \"messages\");\n      onSnapshot(q, querySnapshot => {\n        messages.value = querySnapshot.docs.map(doc => doc.data());\n      });\n    };\n    const sendMessage = async message => {\n      try {\n        const user = auth.currentUser;\n        if (user) {\n          console.log('ああ');\n          const userId = user.uid;\n          // メッセージ送信やその他の操作をここで実行\n        } else {\n          console.error(\"User is not logged in or currentUser is null\");\n          // 必要に応じて、ログインページにリダイレクトするなどの対応を行う\n        }\n        await addDoc(collection(db, \"messages\"), {\n          text: message,\n          timestamp: new Date(),\n          userId: user.uid,\n          userName: user.displayName\n        });\n      } catch (e) {\n        console.error(\"Error adding document: \", e);\n      }\n    };\n    onMounted(fetchMessages);\n    return {\n      messages,\n      sendMessage\n    };\n  }\n};","map":{"version":3,"names":["ref","onMounted","collection","addDoc","onSnapshot","db","auth","MessageList","MessageInput","components","setup","messages","fetchMessages","q","querySnapshot","value","docs","map","doc","data","sendMessage","message","user","currentUser","console","log","userId","uid","error","text","timestamp","Date","userName","displayName","e"],"sources":["/Users/koutaohi/docker/vue-chat/vueApp/vue-sample/src/views/ChatView.vue"],"sourcesContent":["<template>\n  <div class=\"chat-view\">\n    <MessageList :messages=\"messages\" />\n    <MessageInput @sendMessage=\"sendMessage\" />\n    <h1>AAA</h1>\n  </div>\n</template>\n\n<script>\nimport { ref, onMounted } from 'vue';\nimport { collection, addDoc, onSnapshot } from 'firebase/firestore';\nimport { db } from '../firebaseConfig';\nimport { auth } from '../firebaseConfig';\nimport MessageList from '../components/MessageList.vue';\nimport MessageInput from '../components/MessageInput.vue';\nimport 'firebase/auth';\nimport 'firebase/firestore';\n\nexport default {\n  components: {\n    MessageList,\n    MessageInput\n  },\n  setup() {\n    const messages = ref([]);\n\n    const fetchMessages = () => {\n      const q = collection(db, \"messages\");\n      onSnapshot(q, (querySnapshot) => {\n        messages.value = querySnapshot.docs.map(doc => doc.data());\n      });\n    };\n\n    const sendMessage = async (message) => {\n      try {\n        const user = auth.currentUser;\n        if (user) {\n          console.log('ああ')\n          const userId = user.uid;\n          // メッセージ送信やその他の操作をここで実行\n        } else {\n          console.error(\"User is not logged in or currentUser is null\")\n          // 必要に応じて、ログインページにリダイレクトするなどの対応を行う\n        }\n        await addDoc(collection(db, \"messages\"), {\n          text: message,\n          timestamp: new Date(),\n          userId: user.uid,\n          userName: user.displayName,\n        });\n      } catch (e) {\n        console.error(\"Error adding document: \", e);\n      }\n    };\n\n    onMounted(fetchMessages);\n\n    return {\n      messages,\n      sendMessage\n    };\n  }\n};\n</script>\n\n<style scoped>\n.chat-view {\n  display: flex;\n  flex-direction: column;\n  height: 100vh;\n  justify-content: space-between;\n}\n</style>\n"],"mappings":"AASA,SAASA,GAAG,EAAEC,SAAQ,QAAS,KAAK;AACpC,SAASC,UAAU,EAAEC,MAAM,EAAEC,UAAS,QAAS,oBAAoB;AACnE,SAASC,EAAC,QAAS,mBAAmB;AACtC,SAASC,IAAG,QAAS,mBAAmB;AACxC,OAAOC,WAAU,MAAO,+BAA+B;AACvD,OAAOC,YAAW,MAAO,gCAAgC;AACzD,OAAO,eAAe;AACtB,OAAO,oBAAoB;AAE3B,eAAe;EACbC,UAAU,EAAE;IACVF,WAAW;IACXC;EACF,CAAC;EACDE,KAAKA,CAAA,EAAG;IACN,MAAMC,QAAO,GAAIX,GAAG,CAAC,EAAE,CAAC;IAExB,MAAMY,aAAY,GAAIA,CAAA,KAAM;MAC1B,MAAMC,CAAA,GAAIX,UAAU,CAACG,EAAE,EAAE,UAAU,CAAC;MACpCD,UAAU,CAACS,CAAC,EAAGC,aAAa,IAAK;QAC/BH,QAAQ,CAACI,KAAI,GAAID,aAAa,CAACE,IAAI,CAACC,GAAG,CAACC,GAAE,IAAKA,GAAG,CAACC,IAAI,CAAC,CAAC,CAAC;MAC5D,CAAC,CAAC;IACJ,CAAC;IAED,MAAMC,WAAU,GAAI,MAAOC,OAAO,IAAK;MACrC,IAAI;QACF,MAAMC,IAAG,GAAIhB,IAAI,CAACiB,WAAW;QAC7B,IAAID,IAAI,EAAE;UACRE,OAAO,CAACC,GAAG,CAAC,IAAI;UAChB,MAAMC,MAAK,GAAIJ,IAAI,CAACK,GAAG;UACvB;QACF,OAAO;UACLH,OAAO,CAACI,KAAK,CAAC,8CAA8C;UAC5D;QACF;QACA,MAAMzB,MAAM,CAACD,UAAU,CAACG,EAAE,EAAE,UAAU,CAAC,EAAE;UACvCwB,IAAI,EAAER,OAAO;UACbS,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC;UACrBL,MAAM,EAAEJ,IAAI,CAACK,GAAG;UAChBK,QAAQ,EAAEV,IAAI,CAACW;QACjB,CAAC,CAAC;MACJ,EAAE,OAAOC,CAAC,EAAE;QACVV,OAAO,CAACI,KAAK,CAAC,yBAAyB,EAAEM,CAAC,CAAC;MAC7C;IACF,CAAC;IAEDjC,SAAS,CAACW,aAAa,CAAC;IAExB,OAAO;MACLD,QAAQ;MACRS;IACF,CAAC;EACH;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}